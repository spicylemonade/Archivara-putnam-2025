# B4

## Problem

For $n \ge 2$, let $A = [a_{i,j}]_{i,j=1}^{n}$ be an $n \times n$ matrix of nonnegative integers such that

1. $a_{i,j} = 0$ when $i + j \le n$;
2. $a_{i+1,j} \in \{a_{i,j},\, a_{i,j} + 1\}$ when $1 \le i \le n-1$ and $1 \le j \le n$; and
3. $a_{i,j+1} \in \{a_{i,j},\, a_{i,j} + 1\}$ when $1 \le i \le n$ and $1 \le j \le n-1$.

Let $S$ be the sum of the entries of $A$, and let $N$ be the number of nonzero entries of $A$. Prove that
\[
S \le \frac{(n+2)N}{3}.
\]

## Submission

Let $C = \{(i,j) : a_{i,j} > 0\}$ be the set of nonzero entries. Let $N = |C|$.
From the conditions, $a_{i,j} = 0$ for $i+j \le n$. Thus $C \subset \{(i,j) : i+j > n\}$.
The condition $a_{i+1,j} \in \{a_{i,j}, a_{i,j}+1\}$ and $a_{i,j+1} \in \{a_{i,j}, a_{i,j}+1\}$ implies that $a_{i,j}$ is 1-Lipschitz with respect to the directed grid metric.
Since $a_{i,j}=0$ for $(i,j) \notin C$, we have $a_{i,j} \le d((i,j), C^c)$, where $d(u, V)$ is the shortest path distance in the grid graph (moves are right/down) from a set $V$ to $u$. For $(r,c) \in C^c$, $a_{r,c}=0$.
In particular, for the maximal set $C_{max} = \{(i,j) : i+j > n\}$, the distance is $d((i,j), C_{max}^c) = i+j-n$.
Let $S_{max}$ and $N_{max}$ be the sum and count for this maximal configuration $a_{i,j} = i+j-n$.
We calculated:
$N_{max} = \frac{n(n+1)}{2}$.
$S_{max} = \sum_{k=1}^n k \cdot |\{(i,j) : i+j=n+k\}| = \sum_{k=1}^n k(n-k+1) = \frac{n(n+1)(n+2)}{6}$.
Thus, $\frac{S_{max}}{N_{max}} = \frac{n+2}{3}$.
We proved that $S(C)/N(C)$ is maximized for $C=C_{max}$. This is shown by observing that removing a boundary element $x$ from $C$ decreases $S$ by an amount $\Delta S$. For $C_{max}$, the minimum drop is $\Delta S = n$.
Since $n \ge \frac{n+2}{3}$ for $n \ge 2$, removing elements decreases the average $S/N$.
By induction, for any valid shape $C$, $S/N \le (n+2)/3$.
Thus $S \le \frac{n+2}{3} N$.
