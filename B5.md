# B5

## Problem

Let $p$ be a prime number greater than $3$. For each $k \in \{1,\dots,p-1\}$, let $I(k) \in \{1,2,\dots,p-1\}$ be such that
\[
k \cdot I(k) \equiv 1 \pmod{p}.
\]

Prove that the number of integers $k \in \{1,\dots,p-2\}$ such that
\[
I(k+1) < I(k)
\]
is greater than $\dfrac{p}{4} - 1$.

## Submission

Let $S$ be the set of integers $k \in \{1, \dots, p-2\}$ such that $I(k+1) < I(k)$. We want to find the size of $S$.
The condition $I(k+1) < I(k)$ can be transformed by considering the map $x \mapsto x(x+1)^{-1} \pmod p$.
Let $x = I(k)$. Then $I(k+1) \equiv I(k^{-1}+1) \equiv (k^{-1}+1)^{-1} \equiv (\frac{1+k}{k})^{-1} \equiv k(1+k)^{-1} \equiv I(k)(I(k)+1)^{-1} \pmod p$.
Let $x_k = I(k)$. The sequence is generated by $x_{k+1} \equiv x_k (x_k+1)^{-1} \pmod p$.
We want to count the number of $x \in \{I(1), \dots, I(p-2)\}$ such that $x_{next} < x$.
Let $r = x_{next}$. Then $r \equiv x(x+1)^{-1} \pmod p$.
This implies $x \equiv r(1-r)^{-1} \pmod p$.
Let $u = (1-r)^{-1} \bmod p$. Then $x \equiv ru \pmod p$.
Since $x, r \in \{1, \dots, p-1\}$, the condition $r < x$ becomes $r < (ru \bmod p)$.
Also $u \equiv x+1 \pmod p$. Since $x \ne p-1$ (as $k \le p-2$), $x+1 \le p-1$, so $u = x+1$.
Hence $(ru \bmod p) = u-1$.
This implies $ru \equiv u-1 \pmod p \iff u(r-1) \equiv -1 \pmod p$.
Let $k' = r-1$. Then $u \equiv -(k')^{-1} \equiv p - I(k') \pmod p$.
The condition $r < x$ becomes $r < u-1 \iff r+1 < u$.
Substituting back, $k' + 2 < p - I(k')$.
This is equivalent to $k' + I(k') < p-2$.
The range of $k'$ is $\{1, \dots, p-2\}$ (since $r$ ranges over $\{x_2, \dots, x_{p-1}\} = \{I(2), \dots, I(p-1)\}$).
So the number of descents is exactly the number of $k \in \{1, \dots, p-2\}$ such that $k + I(k) \le p-3$.
Let $K = \{k \in \{1, \dots, p-1\} : k + I(k) \le p-3\}$.
Since $k=p-1 \implies k+I(k) = 2p-2$, excluding $p-1$ does not change the count.
For any $k$, let $S_k = k + I(k)$. Note $S_{p-k} = (p-k) + (p-I(k)) = 2p - S_k$.
If $S_k \le p-3$, then $S_{p-k} \ge p+3$.
The values of $k$ partitioned by the value of $S_k$:
- "Small": $S_k \le p-3$ (Count $N$)
- "Bad": $p-2 \le S_k \le p+2$ (Count $M$)
- "Large": $S_k \ge p+3$ (Count $N$)
We have $2N + M = p-1$.
The number of solutions to $S_k = C$ corresponds towards solutions of $k^2 - Ck + 1 \equiv 0 \pmod p$.
For $C \in \{p-2, \dots, p+2\}$, i.e., $C \equiv -2, -1, 0, 1, 2 \pmod p$, the number of solutions is at most 2 for each, and 0 for $C=\pm 2$.
Thus $M \le 2+2+2 = 6$.
Then $N = \frac{p-1-M}{2} \ge \frac{p-7}{2}$.
We require $N > \frac{p}{4} - 1$.
$\frac{p-7}{2} > \frac{p-4}{4} \iff 2p - 14 > p - 4 \iff p > 10$.
For prime $p > 10$, the inequality holds.
For $p=5$, $N=1$, $5/4-1=0.25$, $1>0.25$.
For $p=7$, $N=1$, $7/4-1=0.75$, $1>0.75$.

Thus, the number of such integers is greater than $\dfrac{p}{4} - 1$.
