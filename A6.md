# A6

## Problem

Let $b_0 = 0$ and, for $n \ge 0$, define
\[
b_{n+1} = 2b_n^2 + b_n + 1.
\]

For each $k \ge 1$, show that
\[
b_{2^{k+1}} - 2b_{2^k}
\]
is divisible by $2^{2k+2}$ but not by $2^{2k+3}$.

## Submission

Let $b_0 = 0$ and $b_{n+1} = f(b_n)$ where $f(x) = 2x^2 + x + 1$.
We define $P_m(x) = f^{(m)}(x)$, so that $b_{n+m} = P_m(b_n)$. In particular, $b_m = P_m(0)$.
Let $k \ge 1$ and $m = 2^k$. We examine $D_k = b_{2m} - 2b_m$.
Since $b_{2m} = P_m(b_m)$, we can expand $P_m(x)$ around $x=0$ as a Taylor series:
\[ P_m(x) = c_0 + c_1 x + c_2 x^2 + \dots \]
Here $c_0 = P_m(0) = b_m$.
$c_1 = P_m'(0)$. Let's denote this by $a_m$.
$c_2 = P_m''(0)/2$. Let's denote this by $h_m$.
So $b_{2m} = b_m + a_m b_m + h_m b_m^2 + O(b_m^3)$.
Then $D_k = b_{2m} - 2b_m = b_m(a_m - 1) + h_m b_m^2 + \sum_{j=3}^{m} c_j b_m^j$.

We established the following properties by induction on $k$:
1.  $v_2(b_{2^k}) = k+1$.
    For $k=1$, $b_2=4$, $v_2(4)=2$.
    The inductive step relied on $b_{2m} \equiv b_m(1+a_m) \pmod{b_m^2}$. Since $v_2(1+a_m)=1$, $v_2(b_{2m}) = v_2(b_m)+1$.
2.  $v_2(a_{2^k} - 1) = k+1$.
    For $k=1$, $a_2 = 5$, $v_2(4)=2$.
    The inductive step relied on $a_{2m} \equiv a_m^2 \pmod{2^{k+3}}$, which preserves the valuation pattern $v_2(a_{2m}-1) = v_2(a_m-1)+1$.
3.  The coefficient $h_m$ of $x^2$ in $P_m(x)$ is an even integer.
    For $m=1$, $P_1(x) = 2x^2+x+1$, $h_1=2$.
    The recurrence for coefficients preserves the parity (in fact, $h_n$ is always even).

Using these properties:
-   The term $T_1 = b_m(a_m - 1)$ has valuation $v_2(b_m) + v_2(a_m - 1) = (k+1) + (k+1) = 2k+2$.
-   The term $T_2 = h_m b_m^2$ has valuation $v_2(h_m) + 2v_2(b_m) \ge 1 + 2(k+1) = 2k+3$.
-   Higher order terms involving $b_m^j$ for $j \ge 3$ have valuation at least $3(k+1) = 3k+3$.

Thus, $D_k = T_1 + T_2 + \dots$.
Since $v_2(T_1) = 2k+2$ and the valuation of all other terms is at least $2k+3$, the valuation of the sum is exactly $2k+2$.
This means $b_{2^{k+1}} - 2b_{2^k}$ is divisible by $2^{2k+2}$ but not by $2^{2k+3}$.
